pescafresca_22 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2022.csv", header=FALSE, sep=";")
pescafresca_21 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2021.csv", header=FALSE, sep=";")
pescafresca_20 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2020.csv", header=FALSE, sep=";")
pescafresca_19 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2019.csv", header=FALSE, sep=";")
pescafresca_18 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2018.csv", header=FALSE, sep=";")
pescafresca_17 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2017.csv", header=FALSE, sep=";")
pescafresca_16 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2016.csv", header=FALSE, sep=";")
pescafresca_15 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2015.csv", header=FALSE, sep=";")
pescafresca_14 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2014.csv", header=FALSE, sep=";")
pescafresca_13 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2013.csv", header=FALSE, sep=";")
pescafresca_12 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2012.csv", header=FALSE, sep=";")
pescafresca_11 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2011.csv", header=FALSE, sep=";")
pescafresca_10 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2010.csv", header=FALSE, sep=";")
pescafresca_09 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2009.csv", header=FALSE, sep=";")
pescafresca_08 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2008.csv", header=FALSE, sep=";")
pescafresca_07 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2007.csv", header=FALSE, sep=";")
pescafresca_06 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2006.csv", header=FALSE, sep=";")
pescafresca_05 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2005.csv", header=FALSE, sep=";")
pescafresca_04 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2004.csv", header=FALSE, sep=";")
pescafresca_03 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2003.csv", header=FALSE, sep=";")
pescafresca_22 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2022.csv", header=FALSE, sep=";")
pescafresca_21 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2021.csv", header=FALSE, sep=";")
pescafresca_20 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2020.csv", header=FALSE, sep=";")
pescafresca_19 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2019.csv", header=FALSE, sep=";")
pescafresca_18 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2018.csv", header=FALSE, sep=";")
pescafresca_17 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2017.csv", header=FALSE, sep=";")
pescafresca_16 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2016.csv", header=FALSE, sep=";")
pescafresca_15 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2015.csv", header=FALSE, sep=";")
pescafresca_14 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2014.csv", header=FALSE, sep=";")
pescafresca_13 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2013.csv", header=FALSE, sep=";")
pescafresca_12 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2012.csv", header=FALSE, sep=";")
pescafresca_11 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2011.csv", header=FALSE, sep=";")
pescafresca_10 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2010.csv", header=FALSE, sep=";")
pescafresca_09 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2009.csv", header=FALSE, sep=";")
pescafresca_08 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2008.csv", header=FALSE, sep=";")
pescafresca_07 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2007.csv", header=FALSE, sep=";")
pescafresca_06 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2006.csv", header=FALSE, sep=";")
pescafresca_05 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2005.csv", header=FALSE, sep=";")
pescafresca_04 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2004.csv", header=FALSE, sep=";")
pescafresca_03 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2003.csv", header=FALSE, sep=";")
View(pescafresca_03)
columns_to_convert <- c("col1", "col2", "col3")  # Replace with your actual column names
data[columns_to_convert] <- lapply(data[columns_to_convert], function(x) as.numeric(gsub(",", ".", x)))
# Function to read and clean the CSV files, Convert columns with commas as decimal separators to numeric format with dots
read_and_clean <- function(file_path, col_names) {
data <- read.csv(file_path, sep = ";", header = FALSE)
colnames(data) <- col_names
data <- data %>%
mutate(across(where(is.character), ~ ifelse(grepl("^[0-9.,-]+$", .), as.numeric(gsub(",", ".", .)), .)))
return(data)
}
pescafresca_22 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2022.csv", header=FALSE, sep=";")
pescafresca_21 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2021.csv", header=FALSE, sep=";")
pescafresca_20 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2020.csv", header=FALSE, sep=";")
pescafresca_19 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2019.csv", header=FALSE, sep=";")
pescafresca_18 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2018.csv", header=FALSE, sep=";")
pescafresca_17 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2017.csv", header=FALSE, sep=";")
pescafresca_16 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2016.csv", header=FALSE, sep=";")
pescafresca_15 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2015.csv", header=FALSE, sep=";")
pescafresca_14 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2014.csv", header=FALSE, sep=";")
pescafresca_13 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2013.csv", header=FALSE, sep=";")
pescafresca_12 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2012.csv", header=FALSE, sep=";")
pescafresca_11 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2011.csv", header=FALSE, sep=";")
pescafresca_10 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2010.csv", header=FALSE, sep=";")
pescafresca_09 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2009.csv", header=FALSE, sep=";")
pescafresca_08 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2008.csv", header=FALSE, sep=";")
pescafresca_07 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2007.csv", header=FALSE, sep=";")
pescafresca_06 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2006.csv", header=FALSE, sep=";")
pescafresca_05 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2005.csv", header=FALSE, sep=";")
pescafresca_04 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2004.csv", header=FALSE, sep=";")
pescafresca_03 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2003.csv", header=FALSE, sep=";")
colnames(pescafresca_2022) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_22) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_21) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_20) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_19) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_18) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_17) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_16) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_15) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_14) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_13) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_12) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_11) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_10) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_09) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_08) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_07) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_06) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_05) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_04) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_03) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
View(pescafresca_10)
# Define the columns you want to modify
columns_to_change <- c("kg", "euros", "price_per_kilo")
# Loop through each dataset and apply the transformation
for (year in years) {
# Access the dataset for the current year
df <- pescafresca_data[[as.character(year)]]
# Loop through the columns and replace ',' with '.'
for (col in columns_to_change) {
if (col %in% colnames(df)) {
# Replace commas with periods in the column and convert to numeric
df[[col]] <- as.numeric(gsub(",", ".", df[[col]]))
}
}
# Save the modified data back to the list
pescafresca_data[[as.character(year)]] <- df
}
pescafresca_22 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2022.csv", header=FALSE, sep=";")
pescafresca_21 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2021.csv", header=FALSE, sep=";")
pescafresca_20 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2020.csv", header=FALSE, sep=";")
pescafresca_19 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2019.csv", header=FALSE, sep=";")
pescafresca_18 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2018.csv", header=FALSE, sep=";")
pescafresca_17 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2017.csv", header=FALSE, sep=";")
pescafresca_16 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2016.csv", header=FALSE, sep=";")
pescafresca_15 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2015.csv", header=FALSE, sep=";")
pescafresca_14 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2014.csv", header=FALSE, sep=";")
pescafresca_13 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2013.csv", header=FALSE, sep=";")
pescafresca_12 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2012.csv", header=FALSE, sep=";")
pescafresca_11 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2011.csv", header=FALSE, sep=";")
pescafresca_10 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2010.csv", header=FALSE, sep=";")
pescafresca_09 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2009.csv", header=FALSE, sep=";")
pescafresca_08 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2008.csv", header=FALSE, sep=";")
pescafresca_07 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2007.csv", header=FALSE, sep=";")
pescafresca_06 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2006.csv", header=FALSE, sep=";")
pescafresca_05 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2005.csv", header=FALSE, sep=";")
pescafresca_04 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2004.csv", header=FALSE, sep=";")
pescafresca_03 <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/pescafresca2003.csv", header=FALSE, sep=";")
columns_to_convert <- c("col1", "col2", "col3")  # Replace with your actual column names
data[columns_to_convert] <- lapply(data[columns_to_convert], function(x) as.numeric(gsub(",", ".", x)))
colnames(pescafresca_22) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_21) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_20) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_19) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_18) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_17) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_16) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_15) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_14) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_13) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_12) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_11) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_10) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_09) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_08) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_07) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_06) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_05) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_04) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
colnames(pescafresca_03) <- c("sell_day", "group", "FAOcode", "Galician_name", "Province", "Admi_area", "market", "kg", "euros", "price_per_kilo")
View(pescafresca_15)
View(pescafresca_15)
# Define the columns you want to modify
columns_to_change <- c("kg", "euros", "price_per_kilo")
# Loop through each dataset
for (year in years) {
df <- pescafresca_data[[as.character(year)]]
# replace ',' with '.'
for (col in columns_to_change) {
if (col %in% colnames(df)) {
# Replace commas with periods in the column and convert to numeric
df[[col]] <- as.numeric(gsub(",", ".", df[[col]]))
}
}
# Save the modified data back to the list
pescafresca_data[[as.character(year)]] <- df
}
# Load necessary library
library(dplyr)
# List of file paths for all datasets
file_paths <- list.files(path = "/Users/batume/Documents/R/OHI_GAL/prep/FIS/",
pattern = "pescafresca\\d{4}.csv", full.names = TRUE)
# List of file paths for all datasets
file_paths <- list.files(path = "/Users/batume/Documents/R/OHI_GAL/prep/FIS/",
pattern = "pescafresca\\d{4}.csv", full.names = TRUE)
# Define column names
col_names <- c("sell_day", "group", "FAOcode", "Galician_name", "Province",
"Admi_area", "market", "kg", "euros", "price_per_kilo")
# Function to read, rename columns, and format data
read_and_prepare <- function(file_path) {
data <- read.csv(file_path, header = FALSE, sep = ";", col.names = col_names)
# Convert specific columns from comma to period and to numeric
data <- data %>%
mutate(across(c(kg, euros, price_per_kilo), ~as.numeric(gsub(",", ".", .))))
return(data)
}
# Read and process all files into a list
pescafresca_data <- lapply(file_paths, read_and_prepare)
# Combine all years into one data frame
all_years_data <- bind_rows(pescafresca_data)
# Verify combined data
head(all_years_data)
View(all_years_data)
# Define resilience information if required by CMSY++
# Example resilience levels (modify these as needed for your stocks)
resilience_levels <- c("Very Low", "Low", "Medium", "High")
# Extract a catch time series for each species, FAO code, or area if CMSY++ requires this
cmsy_results <- list()
# Load necessary library
install.packages("CMSY")
library(CMSY)
# Load necessary library
install.packages("CMSY")
library(CMSY)
library("CMSY")
# Load necessary library
install.packages("CMSYShiny")
library("CMSYShiny")
r.version()
r.version
R.version
R.version
# Install installr package if not already installed
if (!requireNamespace("installr", quietly = TRUE)) {
install.packages("installr")
}
# Load the installr package
library(installr)
# Install R version 4.0.5
install.R(version = "4.0.5")
# Define the URL for R 4.0.5
url <- "https://cran.r-project.org/bin/windows/base/old/4.0.5/R-4.0.5-win.exe"
# Define the destination file path
destfile <- tempfile(fileext = ".exe")
# Download the installer for R 4.0.5
download.file(url, destfile, mode = "wb")
# Run the installer
shell(destfile, wait = TRUE)  # Installs R 4.0.5 interactively
# Define the URL for R 4.0.5
url <- "https://cran.r-project.org/bin/windows/base/old/4.0.5/R-4.0.5-win.exe"
# Define the destination file path
destfile <- tempfile(fileext = ".exe")
# Download with a longer timeout (10 minutes)
download.file(url, destfile, mode = "wb", timeout = 600)
# Check if the file was downloaded
if (file.exists(destfile)) {
message("Download complete. Please run the installer manually if it did not auto-start.")
# For Windows users, try to launch the installer directly
if (.Platform$OS.type == "windows") {
shell.exec(destfile)  # Launches installer on Windows
} else {
# For macOS/Linux, provide instructions to run the installer
message("Please manually open the downloaded file at: ", destfile)
}
} else {
message("Download failed. Please try downloading manually from the following link:")
message(url)
}
library(readxl)
library(dplyr)
ices_data <- read_excel("/Users/batume/Documents/R/OHI_GAL/prep/FIS/ICESCatchDataset2006-2022.xlsx", sheet = "Dataset")
table(ices_data$Area)
species_data <- read_excel("/Users/batume/Documents/R/OHI_GAL/prep/FIS/ICESCatchDataset2006-2022.xlsx", sheet = "Species")
galicia_areas <- ices_data %>%
filter(grepl("27.8.c|27.9.a", Area))
merged_data <- galicia_areas %>%
left_join(species_data, by = c("Column1" = "FAO_code"))
Galicia_ices_catch <- merged_data %>%
filter(Country == "ES")
print(Galicia_ices_catch)
library(readxl)
library(dplyr)
ices_data <- read_excel("/Users/batume/Documents/R/OHI_GAL/prep/FIS/ICESCatchDataset2006-2022.xlsx", sheet = "Dataset")
table(ices_data$Area)
species_data <- read_excel("/Users/batume/Documents/R/OHI_GAL/prep/FIS/ICESCatchDataset2006-2022.xlsx", sheet = "Species")
galicia_areas <- ices_data %>%
filter(grepl("27.8.c|27.9.a", Area))
merged_data <- galicia_areas %>%
left_join(species_data, by = c("Column1" = "FAO_code"))
Galicia_ices_catch <- merged_data %>%
filter(Country == "ES")
print(Galicia_ices_catch)
View(Galicia_ices_catch)
etwd("/Users/batume/Documents/R/OHI_GAL/prep/FIS")
#Set wd and load libraries
setwd("/Users/batume/Documents/R/OHI_GAL/prep/FIS")
library(ramlegacy)
library(dplyr)
#Ram data already from RAM package (check version)
download_ramlegacy(version = "4.44")
names(ram_data)
stock_data <- ram_data$stock
#Ram data already from RAM package (check version)
#download_ramlegacy(version = "4.44")
ram_data <- load_ramlegacy(version = "4.44")
names(ram_data)
stock_data <- ram_data$stock
#Filter data for Galicia - use northeast atlantic region and spain.
galicia_data <- ram_data$stock %>%
filter(grepl("Northeast Atlantic", region, ignore.case = TRUE) |
grepl("Spain", areaid, ignore.case = TRUE) |
grepl("ICES", areaid, ignore.case = TRUE))
table(galicia_data$commonname)
#List of species mentioned in the ALTAS DE FLOTA DE BAIXURA DA XUNTA
sp_galicia<-read.csv("/Users/batume/Documents/R/OHI_GAL/prep/FIS/ALL_SPECIES_FISHED_IN_COASTAL_GALICIA.CSV")
View(galicia_data)
unique(ram_data$area)
scientificname <- galicia_data$scientificname
View(galicia_data)
table(galicia_data$commonname)
commonname_scientificname_table <- galicia_data %>%
group_by(commonname, scientificname) %>%
summarize(frequency = n()) %>%
ungroup()
View(commonname_scientificname_table)
write.csv(commonname_scientificname_table, "commonname_scientificname_frequency.csv", row.names = FALSE)
View(commonname_scientificname_table)
View(Galicia_ices_catch)
View(galicia_data)
# Function to download a single CSV file from a URL
download_csv <- function(url, destfile) {
download.file(url, destfile, method = "auto")
cat("Downloaded:", destfile, "\n")
}
setwd("/Users/batume/Documents/R/OHI_GAL/prep/TRS")
setwd("/Users/batume/Documents/R/OHI_GAL/prep/TR")
# Function to download a single CSV file from a URL
download_csv <- function(url, destfile) {
download.file(url, destfile, method = "auto")
cat("Downloaded:", destfile, "\n")
}
url <- "https://www.ige.gal/igebdt/igeapi/datos/6328"
destfile <- "/Users/batume/Documents/R/OHI_GAL/Downloaded/pernoctas_costeiros.csv"
download_csv(url, destfile)
# Read a CSV file with ISO-8859-1 encoding
read_csv_iso88591 <- function(file_path) {
indicadores_costa <- read_csv("/Users/batume/Documents/R/OHI_GAL/prep/TR/TR_IGE_indicadores_COSTA.csv", locale = locale(encoding = "ISO-8859-1"))
return(data)
}
indicadores_costa <- read_csv("/Users/batume/Documents/R/OHI_GAL/prep/TR/TR_IGE_indicadores_COSTA.csv", locale = locale(encoding = "ISO-8859-1"))
# Read a CSV file with ISO-8859-1 encoding
read_csv_iso88591 <- function(file_path) {
indicadores_costa <- read.csv("/Users/batume/Documents/R/OHI_GAL/prep/TR/TR_IGE_indicadores_COSTA.csv", locale = locale(encoding = "ISO-8859-1"))
return(data)
}
read_csv_iso88591
# Set file path
file_path <- "/Users/batume/Documents/R/OHI_GAL/prep/TR/INDICADORES_NOITE_DESTINO_utf8.csv"
# Load the CSV file
data <- read.csv(file_path, encoding = "UTF-8")
View(data)
View(Galicia_ices_catch)
setwd("/Users/batume/Documents/R/OHI_GAL/prep/FIS")
write.csv(Galicia_ices_catch, "Galicia_ices_catch.csv", row.names = FALSE)
# Load the CSV data
data <- Galicia_ices_catch
# Inspect the first few rows to ensure columns are correct
head(data)
# Assuming the columns are named "year", "species", and "tlw"
# Summarize the data to obtain total TLW per year per species
total_tlw <- data %>%
group_by(year, species) %>%
summarize(total_tlw = sum(tlw, na.rm = TRUE))
# View the result
print(total_tlw)
# Load necessary libraries
library(dplyr)
library(tidyr)
# Reshape the data from wide to long format
# Assuming "Species" is the column with species names
long_data <- data %>%
pivot_longer(
cols = -Species,                # Select all columns except "Species" to pivot
names_to = "Year",               # New column for years
values_to = "TLW"                # New column for TLW values
)
colnames(data)
# Inspect the first few rows to understand the structure
head(data)
colnames(data)
# Reshape the data from wide to long format
# Assuming "Species" is the column with species names
long_data <- data %>%
pivot_longer(
cols = -Latin species name,                # Select all columns except "Species" to pivot
# Reshape the data from wide to long format
# Assuming "Species" is the column with species names
long_data <- data %>%
pivot_longer(
cols = -"Latin species name",                # Select all columns except "Species" to pivot
names_to = "Year",               # New column for years
values_to = "TLW"                # New column for TLW values
)
# Convert the "Year" column to numeric if it's currently character
long_data$Year <- as.numeric(long_data$Year)
# Calculate total TLW per year per species (in this case, summing across entries if necessary)
# If each species/year combination is unique, this step may be unnecessary
total_tlw <- long_data %>%
group_by(Species, Year) %>%
summarize(total_tlw = sum(TLW, na.rm = TRUE))
# View the result
print(total_tlw)
long_data <- data %>%
pivot_longer(
cols = -species_name,  # Replace 'species_name' with the actual column name
names_to = "Year",
values_to = "TLW"
)
table(galicia_data$areaid)
eliminate<-table(galicia_data$areaid)
write.csv(eliminate)
# Filter rows that contain "VII" in the 'Var1' column
filtered_data <- data[grepl("VII", data$Var1), ]
View(filtered_data)
filtered_data <- data[grepl("VII", trimws(data$Var1), ignore.case = TRUE), ]
View(filtered_data)
filtered_data <- data[grepl("VII", trimws(data$Var1), ignore.case = TRUE), ]
filtered_data <- data[grepl("VII", trimws(galicia_data$areaid)), ignore.case = TRUE), ]
filtered_data <- data[grepl("VII", trimws(galicia_data$areaid)), ignore.case = TRUE), ]
filtered_data <- data[grepl("VII", trimws(galicia_data$areaid), ignore.case = TRUE), ]
View(filtered_data)
View(galicia_data)
View(filtered_data)
filtered_data <- data[grepl("VII", trimws(galicia_data$areaid), ignore.case = TRUE), ]
filtered_data
View(filtered_data)
galicia_data$areaid
galicia_data
lala <- data[grepl("VII", trimws(galicia_data$areaid), ignore.case = TRUE), ]
View(lala)
table(galicia_data$areaid)
eliminate<-table(filtered_data$areaid)
table(filtered_data$areaid)
View(galicia_areas)
View(galicia_data)
lala <- filtered_data <- data[grepl("VII", galicia_data$areaid), ]
View(lala)
View(Galicia_ices_catch)
View(galicia_data)
lala <- filtered_data <- galicia_data[grepl("VII", galicia_data$areaid), ]
lala
View(lala)
galicia_ram_filtered <- filtered_data <- galicia_data[grepl("VII", galicia_data$areaid), ]
View(galicia_ram_filtered)
#Set wd and load libraries
setwd("/Users/batume/Documents/R/OHI_GAL/prep/FIS")
library(ramlegacy)
library(dplyr)
library(dplyr)
file_paths <- list.files(path = "/Users/batume/Documents/R/OHI_GAL/prep/FIS/",
pattern = "pescafresca\\d{4}.csv", full.names = TRUE)
col_names <- c("sell_day", "group", "FAOcode", "Galician_name", "Province",
"Admi_area", "market", "kg", "euros", "price_per_kilo")
read_and_prepare <- function(file_path) {
data <- read.csv(file_path, header = FALSE, sep = ";", col.names = col_names)
# Convert specific columns from comma to period and to numeric
data <- data %>%
mutate(across(c(kg, euros, price_per_kilo), ~as.numeric(gsub(",", ".", .))))
return(data)
}
pescafresca_data <- lapply(file_paths, read_and_prepare)
all_years_data <- bind_rows(pescafresca_data)
head(all_years_data)
table(all_years_data$Admi_area)
View(all_years_data)
table(all_years_data$market
table(all_years_data$market)
table(all_years_data$market)
try<-all_years_data[all_years_data$Province = "Pontevedra"]
try<-all_years_data[all_years_data$Province == "Pontevedra"]
try<-all_years_data[all_years_data$Province == "Pontevedra",]
View(try)
table(try$market)
try<-all_years_data[all_years_data$market == c("Redondela", "Arcade", "Vilaboa" , "Moaña", "Vigo", "Cangas", "Baiona", "Aldán-Hio", "Vigo (Canido)"),]
# Filter rows where 'market' matches any of the specified values
try <- all_years_data[all_years_data$market %in% c("Redondela", "Arcade", "Vilaboa", "Moaña", "Vigo", "Cangas", "Baiona", "Aldán-Hio", "Vigo (Canido)"), ]
View(try)
data<-try
data<-try
# Group by species and calculate total euros and kg for each
top_species <- data %>%
group_by(Galician_name) %>%
summarise(
total_euros = sum(euros, na.rm = TRUE),
total_kg = sum(kg, na.rm = TRUE)
) %>%
# Arrange by descending total euros and total kg
arrange(desc(total_euros), desc(total_kg)) %>%
# Select the top 10 species
slice_head(n = 10)
# Display the result
print(top_species)
View(top_species)
# Calculate total euros and kg for each species, then filter the original data
top_species <- data %>%
group_by(Galician_name) %>%
summarise(
total_euros = sum(euros, na.rm = TRUE),
total_kg = sum(kg, na.rm = TRUE)
) %>%
# Arrange by descending total euros and total kg
arrange(desc(total_euros), desc(total_kg)) %>%
# Select the top 10 species based on euros and kg
slice_head(n = 10) %>%
# Select only the Galician_name for filtering
pull(Galician_name)
# Filter the original data to keep only rows for the top 10 species
top_species_data <- data %>%
filter(Galician_name %in% top_species)
# Display the result
print(top_species_data)
View(top_species_data)
View(top_species_data)
top_species_data$
top_species_data$Galician_name
table(top_species_data$Galician_name)
# Filter rows where 'market' matches any of the specified values
sansimon_lonxas<- all_years_data[all_years_data$market %in% c("Redondela", "Arcade", "Vilaboa", "Moaña", "Vigo", "Cangas", "Baiona", "Aldán-Hio", "Vigo (Canido)"), ]
write.csv(sansimon_lonxas, "sansimon_lonxas.csv", row.names = FALSE)
source("~/Documents/R/OHI_GAL/prep/FIS/2fish.R", echo=TRUE)
savehistory("R_history.txt")
